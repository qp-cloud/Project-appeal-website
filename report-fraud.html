<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Repot-fraud Form</title>
    <!-- Bootstrap CSS -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Bootstrap JS -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>
    <script src="https://api.longdo.com/map?key=35bbbe40a96e844b27eba45df1ddad0b"></script>
    <style>
        body {
            background-color: #a2e1ec;
        }
        .header {
            background: #ffffff;
            color: #000;
            padding: 10px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 5px solid #2a7cff;
            border-radius: 15px;
            width: 90%;
            margin: 20px auto;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        .header img {
            height: 100px;
        }
        .user-info {
            display: flex;
            align-items: center;
        }
        .user-info span {
            margin-right: 15px;
            font-weight: bold;
            color: #2a7cff;
        }
        .user-info a {
            color: #fff;
            background-color: #2a7cff;
            padding: 5px 10px;
            text-decoration: none;
            border-radius: 5px;
        }
        .form-container {
            margin-top: 50px;
        }
        .error-message {
            color: red;
            font-size: 0.875rem;
        }
        .function-buttons a {
            display: inline-block;
            width: 300px;
            padding: 15px;
            margin: 15px;
            font-size: 18px;
            color: #fff;
            background-color: #2a7cff;
            text-decoration: none;
            border-radius: 8px;
            font-weight: bold;
            transition: background-color 0.3s ease;
        }
        .function-buttons a:hover {
            background-color: #1e60c3;
        }
        .custom-modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
        }
        .custom-modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            width: 80%;
            max-width: 500px;
            padding: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            z-index: 1001;
        }
        .custom-modal h5 {
            margin-bottom: 15px;
            font-size: 1.2rem;
            text-align: center;
        }
        .custom-modal .modal-footer {
            text-align: center;
        }
        .custom-modal .modal-footer button {
            padding: 10px 20px;
            margin: 5px;
            border: none;
            border-radius: 5px;
            font-size: 1rem;
            cursor: pointer;
        }
        .btn-close {
            background: #ccc;
            color: #333;
        }
        .btn-agree {
            background: #007bff;
            color: white;
        }
        .btn-full-width {
            width: 100%;
            padding: 15px;
            font-size: 1.2rem;
            margin-top: 10px;
        }
    </style>
</head>

<body>
    <div class="header">
        <img src="logo.png" alt="Ban Pong Municipality Logo">
        <div class="user-info">
          <span>ยินดีต้อนรับ, [ชื่อผู้ใช้]</span>
          <a href="secondpage.html">กลับสู่หน้าหลัก</a>
        </div>
      </div>
<div class="container form-container">
    <h2 class="text-center mb-4">แจ้งเบาะแสการทุจริตประพฤติมิชอบ</h2>

    <form id="report-person-form">
        
        <!-- Report Subject -->
        <div class="form-group">
            <label for="complaint-subject">เรื่องที่แจ้งเบาะแส <span class="text-danger">*</span></label>
            <input type="text" class="form-control" id="complaint-subject" name="complaint-subject">
            <small class="error-message" id="complaint-subject-error"></small>
        </div>

        <!-- Report person -->
        <div class="form-group">
            <label for="report-person">องค์กร หรือ บุคคลที่ต้องการแจ้งเบาะแส <span class="text-danger">*</span></label>
            <input type="text" class="form-control" id="report-person" name="report-person">
            <small class="error-message" id="report-person-error"></small>
        </div>

        <!-- Contact Phone -->
        <div class="form-group">
            <label for="contact-phone">เบอร์โทรศัพท์ที่สามารถติดต่อได้ <span class="text-danger">*</span></label>
            <input type="tel" class="form-control" id="contact-phone" name="contact-phone">
            <small class="error-message" id="contact-phone-error"></small>
        </div>

        <!-- Location -->
        <div class="form-group">
            <label for="contact-location">สถานที่</label>
            <input type="text" class="form-control" id="contact-location" name="contact-location">
            <small class="error-message" id="contact-location-error"></small>
        </div>

        <!-- Incident Date and Time -->
        <div class="form-group">
            <label for="incident-time">เวลาที่เกิดเหตุหรือพบเหตุ</label>
            <div class="form-row">
                <div class="col">
                    <input type="date" class="form-control" id="incident-date" name="incident-date">
                    <small class="error-message" id="incident-date-error"></small>
                </div>
                <div class="col">
                    <input type="time" class="form-control" id="incident-time" name="incident-time">
                    <small class="error-message" id="incident-time-error"></small>
                </div>
            </div>
        </div>

        <!-- Department -->
        <div class="form-group">
            <label for="department">หน่วยงานที่รับผิดชอบ</label>
            <select class="form-control" id="department" name="department">
                    <option value="เทศบาลเมือง">เทศบาลเมือง</option>
                    <option value="สำนักปลัดเทศบาลเมือง">สำนักปลัดเทศบาลเมือง</option>
                    <option value="กองคลัง">กองคลัง</option>
                    <option value="กองช่าง">กองช่าง</option>
                    <option value="กองการศึกษา">กองการศึกษา</option>
                    <option value="กองสาธารณสุข">กองสาธารณสุข</option>
                    <option value="กองสวัสดิการสังคม">กองสวัสดิการสังคม</option>
                    <option value="กองยุทธศาสตร์">กองยุทธศาสตร์</option>
                    <option value="กองการเจ้าหน้าที่">กองการเจ้าหน้าที่</option>
                    <option value="หน่วยตรวจสอบภายใน">หน่วยตรวจสอบภายใน</option>
                    <option value="หน่วยงานอื่นๆ">หน่วยงานอื่นๆ</option>
            </select>
        </div>

        <!-- Complaint Description -->
        <div class="form-group">
            <label for="complaint-description">รายละเอียดการแจ้งเบาะแส</label>
            <textarea class="form-control" id="complaint-description" name="complaint-description" rows="4"></textarea>
            <small class="error-message" id="complaint-description-error"></small>
        </div>
        <!-- File Upload -->
        <div class="form-group">
            <label for="complaint-file">ไฟล์ที่แนบ</label>
            <input type="file" class="form-control" id="complaint-file" name="complaint_file">
        </div>
        <form id="report-person-form">
            <!-- Form fields go here -->
            <div class="form-check">
                <input type="checkbox" class="form-check-input" id="privacy-consent" disabled>
                <label class="form-check-label" for="privacy-consent">
                    ยินยอมให้ข้อมูลส่วนบุคคล
                    <a href="#" id="show-agreement">[อ่านข้อตกลง]</a>
                </label>
            </div>
            <div id="confirmation-buttons" class="mt-3">
                <button type="button" class="btn btn-success btn-full-width" id="confirm-submit" disabled>ยืนยันการส่งข้อมูล</button>
                <button type="button" class="btn btn-danger btn-full-width" id="cancel-submit">ยกเลิก</button>
            </div>
        </form>
    </div>
    <!-- Custom Modal -->
    <div class="custom-modal-overlay" id="custom-modal-overlay"></div>
    <div class="custom-modal" id="custom-modal">
        <h5>ข้อตกลงการยินยอมให้ข้อมูลส่วนบุคคล</h5>
        <p>ข้อมูลส่วนบุคคลของท่านจะถูกใช้เพื่อประมวลผลคำร้องทุกข์/ร้องเรียนของท่านตามวัตถุประสงค์
            และจะถูกเก็บรักษาอย่างปลอดภัยภายใต้พระราชบัญญัติคุ้มครองข้อมูลส่วนบุคคล พ.ศ.2562</p>
        <div class="modal-footer">
            <button class="btn-close" id="btn-close">ยกเลิก</button>
            <button class="btn-agree" id="btn-agree">ตกลง</button>
        </div>
    </div>    
        <script>
            // Show Agreement Modal
            document.getElementById('show-agreement').addEventListener('click', function (e) {
                e.preventDefault();
                document.getElementById('custom-modal-overlay').style.display = 'block';
                document.getElementById('custom-modal').style.display = 'block';
            });
    
            // Close Modal
            document.getElementById('btn-close').addEventListener('click', function () {
                document.getElementById('custom-modal-overlay').style.display = 'none';
                document.getElementById('custom-modal').style.display = 'none';
            });
    
            // Agree to Consent
            document.getElementById('btn-agree').addEventListener('click', function () {
                document.getElementById('privacy-consent').checked = true;
                document.getElementById('privacy-consent').disabled = false;
                toggleConfirmButton();
                document.getElementById('custom-modal-overlay').style.display = 'none';
                document.getElementById('custom-modal').style.display = 'none';
            });
    
            // Enable/Disable Confirm Button
            document.getElementById('privacy-consent').addEventListener('change', function () {
                toggleConfirmButton();
            });
    
            function toggleConfirmButton() {
                const confirmButton = document.getElementById('confirm-submit');
                confirmButton.disabled = !document.getElementById('privacy-consent').checked;
            }
    
            // Cancel Button Action
            document.getElementById('cancel-submit').addEventListener('click', function () {
                alert('การส่งข้อมูลถูกยกเลิก');
                document.getElementById('report-form').reset();
                toggleConfirmButton();
            });
    
            // Confirm Button Action
            document.getElementById('confirm-submit').addEventListener('click', function (e) {
                e.preventDefault(); // Prevent page refresh
                alert('ส่งข้อมูลสำเร็จ');
                document.getElementById('report-form').reset();
                toggleConfirmButton();
            });
        </script>
    <script>
        let geolocation = { lat: 13.7367, lng: 100.5231 }; // Default location (Bangkok)
        map = new longdo.Map({
            placeholder: document.getElementById('map'),
            defaultCenter: geolocation,
            defaultZoom: 13
    });
        var script = document.createElement('script');
        script.src = "https://mapapi.longdo.com/mapapi?key=35bbbe40a96e844b27eba45df1ddad0b";
        script.onload = initMap;
        document.body.appendChild(script);

        $(document).ready(function() {

            // เปิด Modal เมื่อคลิกที่ลิงก์ "อ่านข้อตกลง"
            $('#show-agreement').click(function(e) {
                e.preventDefault();
            $('#agreement-modal').modal('show'); // เปิด Modal
            });

            // เมื่อผู้ใช้กดปุ่ม "ตกลง" ใน Modal
            $('#agree-consent').click(function() {
            $('#privacy-consent').prop('checked', true); // ติ๊ก checkbox
            $('#privacy-consent').prop('disabled', false); // ปลดล็อก checkbox
            $('#submit-form').prop('disabled', false); // เปิดปุ่มส่งข้อมูล
            $('#agreement-modal').modal('hide'); // ปิด Modal
            });

        // Enable/Disable the submit button based on privacy consent
        $('#privacy-consent').change(function() {
            if ($(this).prop('checked')) {
        $('#submit-form').prop('disabled', false); // เปิดปุ่มส่งข้อมูล
            } else {
        $('#submit-form').prop('disabled', true); // ปิดปุ่มส่งข้อมูล
            }
        });

        // Function to reset error messages
        function resetErrorMessages() {
            $('.error-message').text('');
            $('.form-control').removeClass('is-invalid');
        }
        
        // Function to show error messages
        function showError(inputId, message) {
            $(inputId).addClass('is-invalid');
            $(inputId + '-error').text(message);
        }

        // Validate form on submit
        $('#report-person-form').submit(function(e) {
            e.preventDefault();
            resetErrorMessages();

            let isValid = true;

            // Validate Complaint Subject
            if ($('#complaint-subject').val().trim() === '') {
                showError('#complaint-subject', 'กรุณากรอกเรื่องที่ต้องการแจ้งเบาะแส');
                isValid = false;
            }

            if ($('#report-person').val().trim() === '') {
                showError('#report-person', 'กรุณากรอกชื่อองค์กรหรือบุคคลที่ต้องการแจ้งเบาะแส');
                isValid = false;
            }

            // Validate Contact Phone (basic phone validation)
            const phonePattern = /^[0-9]{10}$/;
            if (!phonePattern.test($('#contact-phone').val())) {
                showError('#contact-phone', 'กรุณากรอกเบอร์โทรศัพท์ให้ถูกต้อง');
                isValid = false;
            }

            // Validate Complaint Details
            if ($('#contact-details').val().trim() === '') {
                showError('#contact-details', 'กรุณากรอกรายละเอียด');
                isValid = false;
            }

            // Validate Privacy Consent
            if (!$('#privacy-consent').prop('checked')) {
                showError('#privacy-consent', 'กรุณายินยอมให้ข้อมูลส่วนบุคคล');
                isValid = false;
            }

            // If form is valid, show the confirmation modal
            if (isValid) {
                $('#confirmation-modal').modal('show');
            }
        });

        // Handle confirmation modal submission
        $('#confirm-submit').click(function() {
            $('#confirmation-modal').modal('hide');
            alert('ข้อมูลถูกส่งเรียบร้อยแล้ว!');
            $('#report-person-form')[0].reset(); // Reset the form
            $('#submit-form').prop('disabled', true); // Disable submit button
        });

        // Handle the cancel button to reset the form
        $('#cancel-form').click(function() {
            if (confirm('คุณแน่ใจหรือไม่ว่าต้องการยกเลิก?')) {
                $('#report-person-form')[0].reset(); // Reset the form
                $('#submit-form').prop('disabled', true); // Disable submit button
            }
        });
    });
</script>
</body>
</html>
